require 'sinatra'
require 'sinatra/reloader' if development?
require 'faraday'

get '/' do
	send_file File.join(settings.public_folder, 'index.html')
end

post '/post' do
	text = params[:text]

	connection = Faraday.new('http://remote.bergcloud.com/') do |c|
		c.request :url_encoded
		c.adapter Faraday.default_adapter
	end

	html = "
	<html>
	<head>
		<style type='text/css'>
			* { margin: 0; }
			body {
				font-family:'Latin Modern Mono Prop';
				width: 384px;
				max-width: 384px;
				min-height: 350px;
				box-sizing: border-box;
				background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAFwCAMAAACGi1yUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NTUxMzQ3OTdCNUMxMUUyQkE4Qzk1RTYzRDI2ODI0NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NTUxMzQ3QTdCNUMxMUUyQkE4Qzk1RTYzRDI2ODI0NyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjc1NTEzNDc3N0I1QzExRTJCQThDOTVFNjNEMjY4MjQ3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjc1NTEzNDc4N0I1QzExRTJCQThDOTVFNjNEMjY4MjQ3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+vsePkgAAAAZQTFRFPT09////Rs3X5QAAAAJ0Uk5T/wDltzBKAAAEFElEQVR42uzdy3KjMBQEUPH/P53t1MR2DEjqi3R6mQWPPiAJylTaIdE0FQAAII8BaH9EoUMA2o2o+A5AGxKtfwPQZgZAGGBjkQsAEbHdAa5uncddgO77A3IGYMYBbO4RB5hBAqCWCIBaIAC2vkEWAHi2x+fHqhXW2cVBlgeofoNsB1BtRm+rTQFP8wAQ9gAQ9gCQ9gAQBgEQ9gAQ5gAQ9gAQNgAAAMDGr4IAAABQFkBFAAAIAAACAIAAACAA1usfAAAA50YnAQBAegEcAAAAAFATQEUAAAgAAAIAgAAAIAAACAAAAgCAAFiifwAAAAAAAABAahEEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0FAPwjR4AAAAm9A8AAAAAAAAAiC2CPgDoCAAAAQBAAAAQAAAEAAABAEAAABAAAOR2/wAAAAAAAACA3CIIAAAAAAAAAAAAAAAAAAAAAAAAAAAASQCfiAEAAGB8/wAAAAAAAACA4CIIQFkAJQEAIAAACAAAAgCAAAAgAAAIAADSo38AAAAASE8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAhvYPoCyAL5QAAAAwaQ4GAAAAAAAAAAAAAKASgJYAABAAAGRQ/wAAAACQnwIAAAAAAAAAAAAAAAAAAAAAAAAArN8/AAAAABSYAgAAAAAAAAAAAAAAAAAAAIDtAXwgM6F/AAAAAKgwBQAAAAAAAAAAAADwJgIAAAAA9noTAQAAAADBKQAAAAAAAAAAAAAAAAAAAADY600EAAAAAASnAAAAAAAAAAAAAAAAAAAAMPlBGAAAAACCUwAAAAD+GqUEAAABAEAArPccBgAAAADBKeANgKoAABAAAAQAAAEAQEY9CAMAsPcIBAAAAAAAAAAAsOcqFACAvUcgAAAAAAAAAEBoEQQgfAMAAAAAAIB952AA4RsAAAAAAIJTAIDwDQAgfAP8AvCJGICt+gcAYO/+AczrH0DF/gF07vpt/e0AMP9ab//kDIAm79T/OgeAkv0DyNYPYEb/p6ZtAHP7B5CtH0D3/v/7wwFgev3HifoBZC9/AOn6AfTt/3T9AML1A+jX/6X6AYTrB9Cn/8v1A+jQ/536AXR99XBpWwB69X9xYwCS9QPo1P+N7QFI1g8gXD+AcP0A7vXfY7MAkvUDCNcP4GL9HTcOIFk/gPP1994BgGT9AE7VP2Qnr3eq/SntvwfYnWBS+58ANiaY1/7x9r+pbkwwsfyXAK9+7Kj9qQCJw6g49EzaaYFhcLtx/wuAKc8gGz1uXQAY/xakZvezz7GdP8A1GFqRU2tXj/ShEK0VO592+6ira7Qvkzq83ufxyCSvjyFXk+4HASylUGSEHD62Kn4QwKMwCi/L1nzF9aB1sQoAABAAACSTHwEGALzuC7KgrdngAAAAAElFTkSuQmCC);
				background-repeat: no-repeat;
			}
			#note {
			    margin-left: 50px;
			    margin-top: 40px;
			    -webkit-transform: rotate(1.5deg);
			    width: 300px;
			    margin-right: 0;
			}
			h1 { font-size: 36px; }
			p { margin-top: 20px; font-size: 28px; }
		</style>
	</head>

	<body>
		<div id='note'>
			<p>#{text}</p>
		</div>
	</body>
</html>"
	
	result = connection.post('playground/direct_print/YOUR_PRINT_CODE', :html => html)

	result.body
	
end